<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Analysis of single cell RNA-seq data</title>
  <meta name="description" content="Analysis of single cell RNA-seq data">
  <meta name="generator" content="bookdown 0.6 and GitBook 2.6.7">

  <meta property="og:title" content="Analysis of single cell RNA-seq data" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Analysis of single cell RNA-seq data" />
  
  
  

<meta name="author" content="Vladimir Kiselev (wikiselev), Tallulah Andrews, Davis McCarthy (davisjmcc), Maren Büttner (marenbuettner) and Martin Hemberg (m_hemberg)">


<meta name="date" content="2018-02-02">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="construction-of-expression-matrix.html">
<link rel="next" href="data-types.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- for Facebook -->  
<meta property="og:url" content="http://hemberg-lab.github.io/scRNA.seq.course/" />
<meta property="og:description" content="In this course we will be surveying the existing problems as well as the available computational and statistical frameworks available for the analysis of scRNA-seq. The course is taught through the University of Cambridge Bioinformatics training unit, but the material found on these pages is meant to be used for anyone interested in learning about computational analysis of scRNA-seq data." />
<meta property="og:image" content="http://hemberg-lab.github.io/scRNA.seq.course/figures/RNA-Seq_workflow-5.pdf.jpg" />

<!-- for Twitter -->          
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Analysis of single-cell RNA-seq data" />
<meta name="twitter:description" content="In this course we will be surveying the existing problems as well as the available computational and statistical frameworks available for the analysis of scRNA-seq. The course is taught through the University of Cambridge Bioinformatics training unit, but the material found on these pages is meant to be used for anyone interested in learning about computational analysis of scRNA-seq data." />
<meta name="twitter:image" content="http://hemberg-lab.github.io/scRNA.seq.course/figures/RNA-Seq_workflow-5.pdf.jpg" />

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-71525309-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html">Table of Contents</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About the course</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#video"><i class="fa fa-check"></i><b>1.1</b> Video</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#registration"><i class="fa fa-check"></i><b>1.2</b> Registration</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#github"><i class="fa fa-check"></i><b>1.3</b> GitHub</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#r-based"><i class="fa fa-check"></i><b>1.4</b> R-based</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#docker-image-rstudio"><i class="fa fa-check"></i><b>1.5</b> Docker image (RStudio)</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#manual-installation"><i class="fa fa-check"></i><b>1.6</b> Manual installation</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.7</b> License</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.8</b> Prerequisites</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#contact"><i class="fa fa-check"></i><b>1.9</b> Contact</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-single-cell-rna-seq.html"><a href="introduction-to-single-cell-rna-seq.html"><i class="fa fa-check"></i><b>2</b> Introduction to single-cell RNA-seq</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-single-cell-rna-seq.html"><a href="introduction-to-single-cell-rna-seq.html#bulk-rna-seq"><i class="fa fa-check"></i><b>2.1</b> Bulk RNA-seq</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-single-cell-rna-seq.html"><a href="introduction-to-single-cell-rna-seq.html#scrna-seq"><i class="fa fa-check"></i><b>2.2</b> scRNA-seq</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-single-cell-rna-seq.html"><a href="introduction-to-single-cell-rna-seq.html#workflow"><i class="fa fa-check"></i><b>2.3</b> Workflow</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-single-cell-rna-seq.html"><a href="introduction-to-single-cell-rna-seq.html#computational-analysis"><i class="fa fa-check"></i><b>2.4</b> Computational Analysis</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-single-cell-rna-seq.html"><a href="introduction-to-single-cell-rna-seq.html#challenges"><i class="fa fa-check"></i><b>2.5</b> Challenges</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-single-cell-rna-seq.html"><a href="introduction-to-single-cell-rna-seq.html#experimental-methods"><i class="fa fa-check"></i><b>2.6</b> Experimental methods</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-single-cell-rna-seq.html"><a href="introduction-to-single-cell-rna-seq.html#what-platform-to-use-for-my-experiment"><i class="fa fa-check"></i><b>2.7</b> What platform to use for my experiment?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="processing-raw-scrna-seq-data.html"><a href="processing-raw-scrna-seq-data.html"><i class="fa fa-check"></i><b>3</b> Processing Raw scRNA-seq Data</a></li>
<li class="chapter" data-level="4" data-path="solution-and-downloading-the-report.html"><a href="solution-and-downloading-the-report.html"><i class="fa fa-check"></i><b>4</b> Solution and Downloading the Report</a></li>
<li class="chapter" data-level="5" data-path="trimming-reads.html"><a href="trimming-reads.html"><i class="fa fa-check"></i><b>5</b> Trimming Reads</a></li>
<li class="chapter" data-level="6" data-path="solution.html"><a href="solution.html"><i class="fa fa-check"></i><b>6</b> Solution</a><ul>
<li class="chapter" data-level="6.1" data-path="solution.html"><a href="solution.html#file-formats"><i class="fa fa-check"></i><b>6.1</b> File formats</a><ul>
<li class="chapter" data-level="6.1.1" data-path="solution.html"><a href="solution.html#fastq"><i class="fa fa-check"></i><b>6.1.1</b> FastQ</a></li>
<li class="chapter" data-level="6.1.2" data-path="solution.html"><a href="solution.html#bam"><i class="fa fa-check"></i><b>6.1.2</b> BAM</a></li>
<li class="chapter" data-level="6.1.3" data-path="solution.html"><a href="solution.html#cram"><i class="fa fa-check"></i><b>6.1.3</b> CRAM</a></li>
<li class="chapter" data-level="6.1.4" data-path="solution.html"><a href="solution.html#mannually-inspecting-files"><i class="fa fa-check"></i><b>6.1.4</b> Mannually Inspecting files</a></li>
<li class="chapter" data-level="6.1.5" data-path="solution.html"><a href="solution.html#genome-fasta-gtf"><i class="fa fa-check"></i><b>6.1.5</b> Genome (FASTA, GTF)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="solution.html"><a href="solution.html#demultiplexing"><i class="fa fa-check"></i><b>6.2</b> Demultiplexing</a><ul>
<li class="chapter" data-level="6.2.1" data-path="solution.html"><a href="solution.html#identifying-cell-containing-dropletsmicrowells"><i class="fa fa-check"></i><b>6.2.1</b> Identifying cell-containing droplets/microwells</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="using-star-to-align-reads.html"><a href="using-star-to-align-reads.html"><i class="fa fa-check"></i><b>7</b> Using STAR to Align Reads</a></li>
<li class="chapter" data-level="8" data-path="solution-for-star-alignment.html"><a href="solution-for-star-alignment.html"><i class="fa fa-check"></i><b>8</b> Solution for STAR Alignment</a></li>
<li class="chapter" data-level="9" data-path="kallisto-and-pseudo-alignment.html"><a href="kallisto-and-pseudo-alignment.html"><i class="fa fa-check"></i><b>9</b> Kallisto and Pseudo-Alignment</a><ul>
<li class="chapter" data-level="9.1" data-path="kallisto-and-pseudo-alignment.html"><a href="kallisto-and-pseudo-alignment.html#what-is-a-k-mer"><i class="fa fa-check"></i><b>9.1</b> What is a k-mer?</a></li>
<li class="chapter" data-level="9.2" data-path="kallisto-and-pseudo-alignment.html"><a href="kallisto-and-pseudo-alignment.html#why-map-k-mers-rather-than-reads"><i class="fa fa-check"></i><b>9.2</b> Why map k-mers rather than reads?</a></li>
<li class="chapter" data-level="9.3" data-path="kallisto-and-pseudo-alignment.html"><a href="kallisto-and-pseudo-alignment.html#kallistos-pseudo-mode"><i class="fa fa-check"></i><b>9.3</b> Kallisto’s pseudo mode</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="solution-to-kallisto-pseudo-alignment.html"><a href="solution-to-kallisto-pseudo-alignment.html"><i class="fa fa-check"></i><b>10</b> Solution to Kallisto Pseudo-Alignment</a><ul>
<li class="chapter" data-level="10.1" data-path="solution-to-kallisto-pseudo-alignment.html"><a href="solution-to-kallisto-pseudo-alignment.html#understanding-the-output-of-kallisto-pseudo-alignment"><i class="fa fa-check"></i><b>10.1</b> Understanding the Output of Kallisto Pseudo-Alignment</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="construction-of-expression-matrix.html"><a href="construction-of-expression-matrix.html"><i class="fa fa-check"></i><b>11</b> Construction of expression matrix</a><ul>
<li class="chapter" data-level="11.1" data-path="construction-of-expression-matrix.html"><a href="construction-of-expression-matrix.html#reads-qc"><i class="fa fa-check"></i><b>11.1</b> Reads QC</a></li>
<li class="chapter" data-level="11.2" data-path="construction-of-expression-matrix.html"><a href="construction-of-expression-matrix.html#reads-alignment"><i class="fa fa-check"></i><b>11.2</b> Reads alignment</a></li>
<li class="chapter" data-level="11.3" data-path="construction-of-expression-matrix.html"><a href="construction-of-expression-matrix.html#alignment-example"><i class="fa fa-check"></i><b>11.3</b> Alignment example</a></li>
<li class="chapter" data-level="11.4" data-path="construction-of-expression-matrix.html"><a href="construction-of-expression-matrix.html#mapping-qc"><i class="fa fa-check"></i><b>11.4</b> Mapping QC</a></li>
<li class="chapter" data-level="11.5" data-path="construction-of-expression-matrix.html"><a href="construction-of-expression-matrix.html#reads-quantification"><i class="fa fa-check"></i><b>11.5</b> Reads quantification</a></li>
<li class="chapter" data-level="11.6" data-path="construction-of-expression-matrix.html"><a href="construction-of-expression-matrix.html#umichapter"><i class="fa fa-check"></i><b>11.6</b> Unique Molecular Identifiers (UMIs)</a><ul>
<li class="chapter" data-level="11.6.1" data-path="construction-of-expression-matrix.html"><a href="construction-of-expression-matrix.html#introduction"><i class="fa fa-check"></i><b>11.6.1</b> Introduction</a></li>
<li class="chapter" data-level="11.6.2" data-path="construction-of-expression-matrix.html"><a href="construction-of-expression-matrix.html#mapping-barcodes"><i class="fa fa-check"></i><b>11.6.2</b> Mapping Barcodes</a></li>
<li class="chapter" data-level="11.6.3" data-path="construction-of-expression-matrix.html"><a href="construction-of-expression-matrix.html#counting-barcodes"><i class="fa fa-check"></i><b>11.6.3</b> Counting Barcodes</a></li>
<li class="chapter" data-level="11.6.4" data-path="construction-of-expression-matrix.html"><a href="construction-of-expression-matrix.html#correcting-for-errors"><i class="fa fa-check"></i><b>11.6.4</b> Correcting for Errors</a></li>
<li class="chapter" data-level="11.6.5" data-path="construction-of-expression-matrix.html"><a href="construction-of-expression-matrix.html#downstream-analysis"><i class="fa fa-check"></i><b>11.6.5</b> Downstream Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html"><i class="fa fa-check"></i><b>12</b> Introduction to R/Bioconductor</a><ul>
<li class="chapter" data-level="12.1" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#installing-packages"><i class="fa fa-check"></i><b>12.1</b> Installing packages</a><ul>
<li class="chapter" data-level="12.1.1" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#cran"><i class="fa fa-check"></i><b>12.1.1</b> CRAN</a></li>
<li class="chapter" data-level="12.1.2" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#github-1"><i class="fa fa-check"></i><b>12.1.2</b> Github</a></li>
<li class="chapter" data-level="12.1.3" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#bioconductor"><i class="fa fa-check"></i><b>12.1.3</b> Bioconductor</a></li>
<li class="chapter" data-level="12.1.4" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#source"><i class="fa fa-check"></i><b>12.1.4</b> Source</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#installation-instructions"><i class="fa fa-check"></i><b>12.2</b> Installation instructions:</a></li>
<li class="chapter" data-level="12.3" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#data-typesclasses"><i class="fa fa-check"></i><b>12.3</b> Data-types/classes</a><ul>
<li class="chapter" data-level="12.3.1" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#numeric"><i class="fa fa-check"></i><b>12.3.1</b> Numeric</a></li>
<li class="chapter" data-level="12.3.2" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#characterstring"><i class="fa fa-check"></i><b>12.3.2</b> Character/String</a></li>
<li class="chapter" data-level="12.3.3" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#logical"><i class="fa fa-check"></i><b>12.3.3</b> Logical</a></li>
<li class="chapter" data-level="12.3.4" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#factors"><i class="fa fa-check"></i><b>12.3.4</b> Factors</a></li>
<li class="chapter" data-level="12.3.5" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#checking-classtype"><i class="fa fa-check"></i><b>12.3.5</b> Checking class/type</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#basic-data-structures"><i class="fa fa-check"></i><b>12.4</b> Basic data structures</a></li>
<li class="chapter" data-level="12.5" data-path="introduction-to-rbioconductor.html"><a href="introduction-to-rbioconductor.html#more-information"><i class="fa fa-check"></i><b>12.5</b> More information</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>13</b> Data Types</a><ul>
<li class="chapter" data-level="13.1" data-path="data-types.html"><a href="data-types.html#what-is-tidy-data"><i class="fa fa-check"></i><b>13.1</b> What is Tidy Data?</a></li>
<li class="chapter" data-level="13.2" data-path="data-types.html"><a href="data-types.html#what-is-rich-data"><i class="fa fa-check"></i><b>13.2</b> What is Rich Data?</a></li>
<li class="chapter" data-level="13.3" data-path="data-types.html"><a href="data-types.html#what-is-bioconductor"><i class="fa fa-check"></i><b>13.3</b> What is Bioconductor?</a></li>
<li class="chapter" data-level="13.4" data-path="data-types.html"><a href="data-types.html#singlecellexperiment-class"><i class="fa fa-check"></i><b>13.4</b> <code>SingleCellExperiment</code> class</a></li>
<li class="chapter" data-level="13.5" data-path="data-types.html"><a href="data-types.html#scater-package"><i class="fa fa-check"></i><b>13.5</b> <code>scater</code> package</a></li>
<li class="chapter" data-level="13.6" data-path="data-types.html"><a href="data-types.html#bioconductor-singlecellexperiment-and-scater"><i class="fa fa-check"></i><b>13.6</b> Bioconductor, <code>SingleCellExperiment</code> and <code>scater</code></a><ul>
<li class="chapter" data-level="13.6.1" data-path="data-types.html"><a href="data-types.html#bioconductor-1"><i class="fa fa-check"></i><b>13.6.1</b> Bioconductor</a></li>
<li class="chapter" data-level="13.6.2" data-path="data-types.html"><a href="data-types.html#singlecellexperiment-class-1"><i class="fa fa-check"></i><b>13.6.2</b> <code>SingleCellExperiment</code> class</a></li>
<li class="chapter" data-level="13.6.3" data-path="data-types.html"><a href="data-types.html#scater-package-1"><i class="fa fa-check"></i><b>13.6.3</b> <code>scater</code> package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="an-introduction-to-ggplot2.html"><a href="an-introduction-to-ggplot2.html"><i class="fa fa-check"></i><b>14</b> An Introduction to ggplot2</a><ul>
<li class="chapter" data-level="14.1" data-path="an-introduction-to-ggplot2.html"><a href="an-introduction-to-ggplot2.html#what-is-ggplot2"><i class="fa fa-check"></i><b>14.1</b> What is ggplot2?</a></li>
<li class="chapter" data-level="14.2" data-path="an-introduction-to-ggplot2.html"><a href="an-introduction-to-ggplot2.html#principles-of-ggplot2"><i class="fa fa-check"></i><b>14.2</b> Principles of ggplot2</a></li>
<li class="chapter" data-level="14.3" data-path="an-introduction-to-ggplot2.html"><a href="an-introduction-to-ggplot2.html#using-the-aes-mapping-function"><i class="fa fa-check"></i><b>14.3</b> Using the <code>aes</code> mapping function</a></li>
<li class="chapter" data-level="14.4" data-path="an-introduction-to-ggplot2.html"><a href="an-introduction-to-ggplot2.html#geoms"><i class="fa fa-check"></i><b>14.4</b> Geoms</a></li>
<li class="chapter" data-level="14.5" data-path="an-introduction-to-ggplot2.html"><a href="an-introduction-to-ggplot2.html#plotting-data-from-more-than-2-cells"><i class="fa fa-check"></i><b>14.5</b> Plotting data from more than 2 cells</a></li>
<li class="chapter" data-level="14.6" data-path="an-introduction-to-ggplot2.html"><a href="an-introduction-to-ggplot2.html#plotting-heatmaps"><i class="fa fa-check"></i><b>14.6</b> Plotting heatmaps</a></li>
<li class="chapter" data-level="14.7" data-path="an-introduction-to-ggplot2.html"><a href="an-introduction-to-ggplot2.html#principle-component-analysis"><i class="fa fa-check"></i><b>14.7</b> Principle Component Analysis</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="tabula-muris.html"><a href="tabula-muris.html"><i class="fa fa-check"></i><b>15</b> Tabula Muris</a><ul>
<li class="chapter" data-level="15.1" data-path="tabula-muris.html"><a href="tabula-muris.html#introduction-1"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="tabula-muris.html"><a href="tabula-muris.html#downloading-the-data"><i class="fa fa-check"></i><b>15.2</b> Downloading the data</a></li>
<li class="chapter" data-level="15.3" data-path="tabula-muris.html"><a href="tabula-muris.html#reading-the-data-smartseq2"><i class="fa fa-check"></i><b>15.3</b> Reading the data (Smartseq2)</a></li>
<li class="chapter" data-level="15.4" data-path="tabula-muris.html"><a href="tabula-muris.html#building-a-scater-object"><i class="fa fa-check"></i><b>15.4</b> Building a scater object</a></li>
<li class="chapter" data-level="15.5" data-path="tabula-muris.html"><a href="tabula-muris.html#reading-the-data-10x"><i class="fa fa-check"></i><b>15.5</b> Reading the data (10X)</a></li>
<li class="chapter" data-level="15.6" data-path="tabula-muris.html"><a href="tabula-muris.html#building-a-scater-object-1"><i class="fa fa-check"></i><b>15.6</b> Building a scater object</a></li>
<li class="chapter" data-level="15.7" data-path="tabula-muris.html"><a href="tabula-muris.html#advanced-exercise"><i class="fa fa-check"></i><b>15.7</b> Advanced Exercise</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html"><i class="fa fa-check"></i><b>16</b> Cleaning the Expression Matrix</a><ul>
<li class="chapter" data-level="16.1" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#exprs-qc"><i class="fa fa-check"></i><b>16.1</b> Expression QC (UMI)</a><ul>
<li class="chapter" data-level="16.1.1" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#introduction-2"><i class="fa fa-check"></i><b>16.1.1</b> Introduction</a></li>
<li class="chapter" data-level="16.1.2" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#tung-dataset"><i class="fa fa-check"></i><b>16.1.2</b> Tung dataset</a></li>
<li class="chapter" data-level="16.1.3" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#cell-qc"><i class="fa fa-check"></i><b>16.1.3</b> Cell QC</a></li>
<li class="chapter" data-level="16.1.4" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#cell-filtering"><i class="fa fa-check"></i><b>16.1.4</b> Cell filtering</a></li>
<li class="chapter" data-level="16.1.5" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#compare-filterings"><i class="fa fa-check"></i><b>16.1.5</b> Compare filterings</a></li>
<li class="chapter" data-level="16.1.6" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#gene-analysis"><i class="fa fa-check"></i><b>16.1.6</b> Gene analysis</a></li>
<li class="chapter" data-level="16.1.7" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#save-the-data"><i class="fa fa-check"></i><b>16.1.7</b> Save the data</a></li>
<li class="chapter" data-level="16.1.8" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#big-exercise"><i class="fa fa-check"></i><b>16.1.8</b> Big Exercise</a></li>
<li class="chapter" data-level="16.1.9" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#sessioninfo"><i class="fa fa-check"></i><b>16.1.9</b> sessionInfo()</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#expression-qc-reads"><i class="fa fa-check"></i><b>16.2</b> Expression QC (Reads)</a></li>
<li class="chapter" data-level="16.3" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#data-visualization"><i class="fa fa-check"></i><b>16.3</b> Data visualization</a><ul>
<li class="chapter" data-level="16.3.1" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#introduction-3"><i class="fa fa-check"></i><b>16.3.1</b> Introduction</a></li>
<li class="chapter" data-level="16.3.2" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#visual-pca"><i class="fa fa-check"></i><b>16.3.2</b> PCA plot</a></li>
<li class="chapter" data-level="16.3.3" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#visual-tsne"><i class="fa fa-check"></i><b>16.3.3</b> tSNE map</a></li>
<li class="chapter" data-level="16.3.4" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#big-exercise-1"><i class="fa fa-check"></i><b>16.3.4</b> Big Exercise</a></li>
<li class="chapter" data-level="16.3.5" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#sessioninfo-1"><i class="fa fa-check"></i><b>16.3.5</b> sessionInfo()</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#data-visualization-reads"><i class="fa fa-check"></i><b>16.4</b> Data visualization (Reads)</a></li>
<li class="chapter" data-level="16.5" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#identifying-confounding-factors"><i class="fa fa-check"></i><b>16.5</b> Identifying confounding factors</a><ul>
<li class="chapter" data-level="16.5.1" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#introduction-4"><i class="fa fa-check"></i><b>16.5.1</b> Introduction</a></li>
<li class="chapter" data-level="16.5.2" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#correlations-with-pcs"><i class="fa fa-check"></i><b>16.5.2</b> Correlations with PCs</a></li>
<li class="chapter" data-level="16.5.3" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#explanatory-variables"><i class="fa fa-check"></i><b>16.5.3</b> Explanatory variables</a></li>
<li class="chapter" data-level="16.5.4" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#other-confounders"><i class="fa fa-check"></i><b>16.5.4</b> Other confounders</a></li>
<li class="chapter" data-level="16.5.5" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#exercise"><i class="fa fa-check"></i><b>16.5.5</b> Exercise</a></li>
<li class="chapter" data-level="16.5.6" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#sessioninfo-2"><i class="fa fa-check"></i><b>16.5.6</b> sessionInfo()</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#identifying-confounding-factors-reads"><i class="fa fa-check"></i><b>16.6</b> Identifying confounding factors (Reads)</a></li>
<li class="chapter" data-level="16.7" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#normalization-theory"><i class="fa fa-check"></i><b>16.7</b> Normalization theory</a><ul>
<li class="chapter" data-level="16.7.1" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#introduction-5"><i class="fa fa-check"></i><b>16.7.1</b> Introduction</a></li>
<li class="chapter" data-level="16.7.2" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#library-size-1"><i class="fa fa-check"></i><b>16.7.2</b> Library size</a></li>
<li class="chapter" data-level="16.7.3" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#normalisations"><i class="fa fa-check"></i><b>16.7.3</b> Normalisations</a></li>
<li class="chapter" data-level="16.7.4" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#effectiveness"><i class="fa fa-check"></i><b>16.7.4</b> Effectiveness</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#normalization-practice-umi"><i class="fa fa-check"></i><b>16.8</b> Normalization practice (UMI)</a><ul>
<li class="chapter" data-level="16.8.1" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#raw"><i class="fa fa-check"></i><b>16.8.1</b> Raw</a></li>
<li class="chapter" data-level="16.8.2" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#cpm-1"><i class="fa fa-check"></i><b>16.8.2</b> CPM</a></li>
<li class="chapter" data-level="16.8.3" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#size-factor-rle"><i class="fa fa-check"></i><b>16.8.3</b> Size-factor (RLE)</a></li>
<li class="chapter" data-level="16.8.4" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#upperquantile"><i class="fa fa-check"></i><b>16.8.4</b> Upperquantile</a></li>
<li class="chapter" data-level="16.8.5" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#tmm-1"><i class="fa fa-check"></i><b>16.8.5</b> TMM</a></li>
<li class="chapter" data-level="16.8.6" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#scran-1"><i class="fa fa-check"></i><b>16.8.6</b> scran</a></li>
<li class="chapter" data-level="16.8.7" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#downsampling-1"><i class="fa fa-check"></i><b>16.8.7</b> Downsampling</a></li>
<li class="chapter" data-level="16.8.8" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#normalisation-for-genetranscript-length"><i class="fa fa-check"></i><b>16.8.8</b> Normalisation for gene/transcript length</a></li>
<li class="chapter" data-level="16.8.9" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#exercise-1"><i class="fa fa-check"></i><b>16.8.9</b> Exercise</a></li>
<li class="chapter" data-level="16.8.10" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#sessioninfo-3"><i class="fa fa-check"></i><b>16.8.10</b> sessionInfo()</a></li>
</ul></li>
<li class="chapter" data-level="16.9" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#normalization-practice-reads"><i class="fa fa-check"></i><b>16.9</b> Normalization practice (Reads)</a></li>
<li class="chapter" data-level="16.10" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#dealing-with-confounders"><i class="fa fa-check"></i><b>16.10</b> Dealing with confounders</a><ul>
<li class="chapter" data-level="16.10.1" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#introduction-6"><i class="fa fa-check"></i><b>16.10.1</b> Introduction</a></li>
<li class="chapter" data-level="16.10.2" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#remove-unwanted-variation"><i class="fa fa-check"></i><b>16.10.2</b> Remove Unwanted Variation</a></li>
<li class="chapter" data-level="16.10.3" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#combat"><i class="fa fa-check"></i><b>16.10.3</b> Combat</a></li>
<li class="chapter" data-level="16.10.4" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#mnncorrect"><i class="fa fa-check"></i><b>16.10.4</b> mnnCorrect</a></li>
<li class="chapter" data-level="16.10.5" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#glm"><i class="fa fa-check"></i><b>16.10.5</b> GLM</a></li>
<li class="chapter" data-level="16.10.6" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#how-to-evaluate-and-compare-confounder-removal-strategies"><i class="fa fa-check"></i><b>16.10.6</b> How to evaluate and compare confounder removal strategies</a></li>
<li class="chapter" data-level="16.10.7" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#big-exercise-2"><i class="fa fa-check"></i><b>16.10.7</b> Big Exercise</a></li>
<li class="chapter" data-level="16.10.8" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#sessioninfo-4"><i class="fa fa-check"></i><b>16.10.8</b> sessionInfo()</a></li>
</ul></li>
<li class="chapter" data-level="16.11" data-path="cleaning-the-expression-matrix.html"><a href="cleaning-the-expression-matrix.html#dealing-with-confounders-reads"><i class="fa fa-check"></i><b>16.11</b> Dealing with confounders (Reads)</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="biological-analysis.html"><a href="biological-analysis.html"><i class="fa fa-check"></i><b>17</b> Biological Analysis</a><ul>
<li class="chapter" data-level="17.1" data-path="biological-analysis.html"><a href="biological-analysis.html#clustering-introduction"><i class="fa fa-check"></i><b>17.1</b> Clustering Introduction</a><ul>
<li class="chapter" data-level="17.1.1" data-path="biological-analysis.html"><a href="biological-analysis.html#introduction-7"><i class="fa fa-check"></i><b>17.1.1</b> Introduction</a></li>
<li class="chapter" data-level="17.1.2" data-path="biological-analysis.html"><a href="biological-analysis.html#dimensionality-reductions"><i class="fa fa-check"></i><b>17.1.2</b> Dimensionality reductions</a></li>
<li class="chapter" data-level="17.1.3" data-path="biological-analysis.html"><a href="biological-analysis.html#clustering-methods"><i class="fa fa-check"></i><b>17.1.3</b> Clustering methods</a></li>
<li class="chapter" data-level="17.1.4" data-path="biological-analysis.html"><a href="biological-analysis.html#challenges-in-clustering"><i class="fa fa-check"></i><b>17.1.4</b> Challenges in clustering</a></li>
<li class="chapter" data-level="17.1.5" data-path="biological-analysis.html"><a href="biological-analysis.html#tools-for-scrna-seq-data"><i class="fa fa-check"></i><b>17.1.5</b> Tools for scRNA-seq data</a></li>
<li class="chapter" data-level="17.1.6" data-path="biological-analysis.html"><a href="biological-analysis.html#comparing-clustering"><i class="fa fa-check"></i><b>17.1.6</b> Comparing clustering</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="biological-analysis.html"><a href="biological-analysis.html#clust-methods"><i class="fa fa-check"></i><b>17.2</b> Clustering example</a><ul>
<li class="chapter" data-level="17.2.1" data-path="biological-analysis.html"><a href="biological-analysis.html#deng-dataset"><i class="fa fa-check"></i><b>17.2.1</b> Deng dataset</a></li>
<li class="chapter" data-level="17.2.2" data-path="biological-analysis.html"><a href="biological-analysis.html#sc3-1"><i class="fa fa-check"></i><b>17.2.2</b> SC3</a></li>
<li class="chapter" data-level="17.2.3" data-path="biological-analysis.html"><a href="biological-analysis.html#pcareduce-1"><i class="fa fa-check"></i><b>17.2.3</b> pcaReduce</a></li>
<li class="chapter" data-level="17.2.4" data-path="biological-analysis.html"><a href="biological-analysis.html#tsne-kmeans"><i class="fa fa-check"></i><b>17.2.4</b> tSNE + kmeans</a></li>
<li class="chapter" data-level="17.2.5" data-path="biological-analysis.html"><a href="biological-analysis.html#snn-cliq-1"><i class="fa fa-check"></i><b>17.2.5</b> SNN-Cliq</a></li>
<li class="chapter" data-level="17.2.6" data-path="biological-analysis.html"><a href="biological-analysis.html#sincera-1"><i class="fa fa-check"></i><b>17.2.6</b> SINCERA</a></li>
<li class="chapter" data-level="17.2.7" data-path="biological-analysis.html"><a href="biological-analysis.html#sessioninfo-5"><i class="fa fa-check"></i><b>17.2.7</b> sessionInfo()</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="biological-analysis.html"><a href="biological-analysis.html#feature-selection"><i class="fa fa-check"></i><b>17.3</b> Feature Selection</a><ul>
<li class="chapter" data-level="17.3.1" data-path="biological-analysis.html"><a href="biological-analysis.html#identifying-genes-vs-a-null-model"><i class="fa fa-check"></i><b>17.3.1</b> Identifying Genes vs a Null Model</a></li>
<li class="chapter" data-level="17.3.2" data-path="biological-analysis.html"><a href="biological-analysis.html#correlated-expression"><i class="fa fa-check"></i><b>17.3.2</b> Correlated Expression</a></li>
<li class="chapter" data-level="17.3.3" data-path="biological-analysis.html"><a href="biological-analysis.html#comparing-methods"><i class="fa fa-check"></i><b>17.3.3</b> Comparing Methods</a></li>
<li class="chapter" data-level="17.3.4" data-path="biological-analysis.html"><a href="biological-analysis.html#sessioninfo-6"><i class="fa fa-check"></i><b>17.3.4</b> sessionInfo()</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="biological-analysis.html"><a href="biological-analysis.html#pseudotime-analysis"><i class="fa fa-check"></i><b>17.4</b> Pseudotime analysis</a><ul>
<li class="chapter" data-level="17.4.1" data-path="biological-analysis.html"><a href="biological-analysis.html#tscan"><i class="fa fa-check"></i><b>17.4.1</b> TSCAN</a></li>
<li class="chapter" data-level="17.4.2" data-path="biological-analysis.html"><a href="biological-analysis.html#monocle"><i class="fa fa-check"></i><b>17.4.2</b> monocle</a></li>
<li class="chapter" data-level="17.4.3" data-path="biological-analysis.html"><a href="biological-analysis.html#diffusion-maps"><i class="fa fa-check"></i><b>17.4.3</b> Diffusion maps</a></li>
<li class="chapter" data-level="17.4.4" data-path="biological-analysis.html"><a href="biological-analysis.html#slicer"><i class="fa fa-check"></i><b>17.4.4</b> SLICER</a></li>
<li class="chapter" data-level="17.4.5" data-path="biological-analysis.html"><a href="biological-analysis.html#comparison-of-the-methods"><i class="fa fa-check"></i><b>17.4.5</b> Comparison of the methods</a></li>
<li class="chapter" data-level="17.4.6" data-path="biological-analysis.html"><a href="biological-analysis.html#expression-of-genes-through-time"><i class="fa fa-check"></i><b>17.4.6</b> Expression of genes through time</a></li>
<li class="chapter" data-level="17.4.7" data-path="biological-analysis.html"><a href="biological-analysis.html#sessioninfo-7"><i class="fa fa-check"></i><b>17.4.7</b> sessionInfo()</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="biological-analysis.html"><a href="biological-analysis.html#imputation"><i class="fa fa-check"></i><b>17.5</b> Imputation</a><ul>
<li class="chapter" data-level="17.5.1" data-path="biological-analysis.html"><a href="biological-analysis.html#scimpute"><i class="fa fa-check"></i><b>17.5.1</b> scImpute</a></li>
<li class="chapter" data-level="17.5.2" data-path="biological-analysis.html"><a href="biological-analysis.html#magic"><i class="fa fa-check"></i><b>17.5.2</b> MAGIC</a></li>
<li class="chapter" data-level="17.5.3" data-path="biological-analysis.html"><a href="biological-analysis.html#sessioninfo-8"><i class="fa fa-check"></i><b>17.5.3</b> sessionInfo()</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="biological-analysis.html"><a href="biological-analysis.html#dechapter"><i class="fa fa-check"></i><b>17.6</b> Differential Expression (DE) analysis</a><ul>
<li class="chapter" data-level="17.6.1" data-path="biological-analysis.html"><a href="biological-analysis.html#bulk-rna-seq-1"><i class="fa fa-check"></i><b>17.6.1</b> Bulk RNA-seq</a></li>
<li class="chapter" data-level="17.6.2" data-path="biological-analysis.html"><a href="biological-analysis.html#single-cell-rna-seq"><i class="fa fa-check"></i><b>17.6.2</b> Single cell RNA-seq</a></li>
<li class="chapter" data-level="17.6.3" data-path="biological-analysis.html"><a href="biological-analysis.html#differences-in-distribution"><i class="fa fa-check"></i><b>17.6.3</b> Differences in Distribution</a></li>
<li class="chapter" data-level="17.6.4" data-path="biological-analysis.html"><a href="biological-analysis.html#models-of-single-cell-rnaseq-data"><i class="fa fa-check"></i><b>17.6.4</b> Models of single-cell RNASeq data</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="biological-analysis.html"><a href="biological-analysis.html#de-in-a-real-dataset"><i class="fa fa-check"></i><b>17.7</b> DE in a real dataset</a><ul>
<li class="chapter" data-level="17.7.1" data-path="biological-analysis.html"><a href="biological-analysis.html#introduction-8"><i class="fa fa-check"></i><b>17.7.1</b> Introduction</a></li>
<li class="chapter" data-level="17.7.2" data-path="biological-analysis.html"><a href="biological-analysis.html#kolmogorov-smirnov-test"><i class="fa fa-check"></i><b>17.7.2</b> Kolmogorov-Smirnov test</a></li>
<li class="chapter" data-level="17.7.3" data-path="biological-analysis.html"><a href="biological-analysis.html#wilcoxmann-whitney-u-test"><i class="fa fa-check"></i><b>17.7.3</b> Wilcox/Mann-Whitney-U Test</a></li>
<li class="chapter" data-level="17.7.4" data-path="biological-analysis.html"><a href="biological-analysis.html#edger"><i class="fa fa-check"></i><b>17.7.4</b> edgeR</a></li>
<li class="chapter" data-level="17.7.5" data-path="biological-analysis.html"><a href="biological-analysis.html#monocle-1"><i class="fa fa-check"></i><b>17.7.5</b> Monocle</a></li>
<li class="chapter" data-level="17.7.6" data-path="biological-analysis.html"><a href="biological-analysis.html#mast"><i class="fa fa-check"></i><b>17.7.6</b> MAST</a></li>
<li class="chapter" data-level="17.7.7" data-path="biological-analysis.html"><a href="biological-analysis.html#slow-methods-1h-to-run"><i class="fa fa-check"></i><b>17.7.7</b> Slow Methods (&gt;1h to run)</a></li>
<li class="chapter" data-level="17.7.8" data-path="biological-analysis.html"><a href="biological-analysis.html#bpsc"><i class="fa fa-check"></i><b>17.7.8</b> BPSC</a></li>
<li class="chapter" data-level="17.7.9" data-path="biological-analysis.html"><a href="biological-analysis.html#scde"><i class="fa fa-check"></i><b>17.7.9</b> SCDE</a></li>
<li class="chapter" data-level="17.7.10" data-path="biological-analysis.html"><a href="biological-analysis.html#sessioninfo-9"><i class="fa fa-check"></i><b>17.7.10</b> sessionInfo()</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html"><i class="fa fa-check"></i><b>18</b> Comparing/Combining scRNASeq datasets</a><ul>
<li class="chapter" data-level="18.1" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#introduction-9"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#datasets"><i class="fa fa-check"></i><b>18.2</b> Datasets</a></li>
<li class="chapter" data-level="18.3" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#projecting-cells-onto-annotated-cell-types-scmap"><i class="fa fa-check"></i><b>18.3</b> Projecting cells onto annotated cell-types (scmap)</a><ul>
<li class="chapter" data-level="18.3.1" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#cell-to-cell-mapping"><i class="fa fa-check"></i><b>18.3.1</b> Cell-to-Cell mapping</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#metaneighbour"><i class="fa fa-check"></i><b>18.4</b> Metaneighbour</a><ul>
<li class="chapter" data-level="18.4.1" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#prepare-data"><i class="fa fa-check"></i><b>18.4.1</b> Prepare Data</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#mnncorrect-1"><i class="fa fa-check"></i><b>18.5</b> mnnCorrect</a></li>
<li class="chapter" data-level="18.6" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#cannonical-correlation-analysis-seurat"><i class="fa fa-check"></i><b>18.6</b> Cannonical Correlation Analysis (Seurat)</a><ul>
<li class="chapter" data-level="18.6.1" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#sessioninfo-10"><i class="fa fa-check"></i><b>18.6.1</b> sessionInfo()</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#search-scrna-seq-data"><i class="fa fa-check"></i><b>18.7</b> Search scRNA-Seq data</a><ul>
<li class="chapter" data-level="18.7.1" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#about"><i class="fa fa-check"></i><b>18.7.1</b> About</a></li>
<li class="chapter" data-level="18.7.2" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#dataset"><i class="fa fa-check"></i><b>18.7.2</b> Dataset</a></li>
<li class="chapter" data-level="18.7.3" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#gene-index"><i class="fa fa-check"></i><b>18.7.3</b> Gene Index</a></li>
<li class="chapter" data-level="18.7.4" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#marker-genes"><i class="fa fa-check"></i><b>18.7.4</b> Marker genes</a></li>
<li class="chapter" data-level="18.7.5" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#search-cells-by-a-gene-list"><i class="fa fa-check"></i><b>18.7.5</b> Search cells by a gene list</a></li>
<li class="chapter" data-level="18.7.6" data-path="comparingcombining-scrnaseq-datasets.html"><a href="comparingcombining-scrnaseq-datasets.html#sessioninfo-11"><i class="fa fa-check"></i><b>18.7.6</b> sessionInfo()</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="seurat-chapter.html"><a href="seurat-chapter.html"><i class="fa fa-check"></i><b>19</b> Seurat</a><ul>
<li class="chapter" data-level="19.1" data-path="seurat-chapter.html"><a href="seurat-chapter.html#seurat-object-class"><i class="fa fa-check"></i><b>19.1</b> <code>Seurat</code> object class</a></li>
<li class="chapter" data-level="19.2" data-path="seurat-chapter.html"><a href="seurat-chapter.html#expression-qc"><i class="fa fa-check"></i><b>19.2</b> Expression QC</a></li>
<li class="chapter" data-level="19.3" data-path="seurat-chapter.html"><a href="seurat-chapter.html#normalization"><i class="fa fa-check"></i><b>19.3</b> Normalization</a></li>
<li class="chapter" data-level="19.4" data-path="seurat-chapter.html"><a href="seurat-chapter.html#highly-variable-genes-1"><i class="fa fa-check"></i><b>19.4</b> Highly variable genes</a></li>
<li class="chapter" data-level="19.5" data-path="seurat-chapter.html"><a href="seurat-chapter.html#dealing-with-confounders-1"><i class="fa fa-check"></i><b>19.5</b> Dealing with confounders</a></li>
<li class="chapter" data-level="19.6" data-path="seurat-chapter.html"><a href="seurat-chapter.html#linear-dimensionality-reduction"><i class="fa fa-check"></i><b>19.6</b> Linear dimensionality reduction</a></li>
<li class="chapter" data-level="19.7" data-path="seurat-chapter.html"><a href="seurat-chapter.html#significant-pcs"><i class="fa fa-check"></i><b>19.7</b> Significant PCs</a></li>
<li class="chapter" data-level="19.8" data-path="seurat-chapter.html"><a href="seurat-chapter.html#clustering-cells"><i class="fa fa-check"></i><b>19.8</b> Clustering cells</a></li>
<li class="chapter" data-level="19.9" data-path="seurat-chapter.html"><a href="seurat-chapter.html#marker-genes-1"><i class="fa fa-check"></i><b>19.9</b> Marker genes</a></li>
<li class="chapter" data-level="19.10" data-path="seurat-chapter.html"><a href="seurat-chapter.html#sessioninfo-12"><i class="fa fa-check"></i><b>19.10</b> sessionInfo()</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="ideal-scrnaseq-pipeline-as-of-oct-2017.html"><a href="ideal-scrnaseq-pipeline-as-of-oct-2017.html"><i class="fa fa-check"></i><b>20</b> “Ideal” scRNAseq pipeline (as of Oct 2017)</a><ul>
<li class="chapter" data-level="20.1" data-path="ideal-scrnaseq-pipeline-as-of-oct-2017.html"><a href="ideal-scrnaseq-pipeline-as-of-oct-2017.html#experimental-design"><i class="fa fa-check"></i><b>20.1</b> Experimental Design</a></li>
<li class="chapter" data-level="20.2" data-path="ideal-scrnaseq-pipeline-as-of-oct-2017.html"><a href="ideal-scrnaseq-pipeline-as-of-oct-2017.html#processing-reads"><i class="fa fa-check"></i><b>20.2</b> Processing Reads</a></li>
<li class="chapter" data-level="20.3" data-path="ideal-scrnaseq-pipeline-as-of-oct-2017.html"><a href="ideal-scrnaseq-pipeline-as-of-oct-2017.html#preparing-expression-matrix"><i class="fa fa-check"></i><b>20.3</b> Preparing Expression Matrix</a></li>
<li class="chapter" data-level="20.4" data-path="ideal-scrnaseq-pipeline-as-of-oct-2017.html"><a href="ideal-scrnaseq-pipeline-as-of-oct-2017.html#biological-interpretation"><i class="fa fa-check"></i><b>20.4</b> Biological Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="advanced-exercises.html"><a href="advanced-exercises.html"><i class="fa fa-check"></i><b>21</b> Advanced exercises</a></li>
<li class="chapter" data-level="22" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>22</b> Resources</a><ul>
<li class="chapter" data-level="22.1" data-path="resources.html"><a href="resources.html#scrna-seq-protocols"><i class="fa fa-check"></i><b>22.1</b> scRNA-seq protocols</a></li>
<li class="chapter" data-level="22.2" data-path="resources.html"><a href="resources.html#external-rna-control-consortium-ercc"><i class="fa fa-check"></i><b>22.2</b> External RNA Control Consortium (ERCC)</a></li>
<li class="chapter" data-level="22.3" data-path="resources.html"><a href="resources.html#scrna-seq-analysis-tools"><i class="fa fa-check"></i><b>22.3</b> scRNA-seq analysis tools</a></li>
<li class="chapter" data-level="22.4" data-path="resources.html"><a href="resources.html#scrna-seq-public-datasets"><i class="fa fa-check"></i><b>22.4</b> scRNA-seq public datasets</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>23</b> References</a></li>
<li class="divider"></li>
<li><a href="http://www.sanger.ac.uk/science/groups/hemberg-group" target="blank">Hemberg Lab, 2017</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysis of single cell RNA-seq data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-rbioconductor" class="section level1">
<h1><span class="header-section-number">12</span> Introduction to R/Bioconductor</h1>
<div id="installing-packages" class="section level2">
<h2><span class="header-section-number">12.1</span> Installing packages</h2>
<div id="cran" class="section level3">
<h3><span class="header-section-number">12.1.1</span> CRAN</h3>
<p>The Comprehensive R Archive Network <a href="https://cran.r-project.org/">CRAN</a> is the biggest archive of R packages. There are few requirements for uploading packages besides building and installing succesfully, hence documentation and support is often minimal and figuring how to use these packages can be a challenge it itself. CRAN is the default repository R will search to find packages to install:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)
<span class="kw">require</span>(<span class="st">&quot;devtools&quot;</span>)</code></pre></div>
</div>
<div id="github-1" class="section level3">
<h3><span class="header-section-number">12.1.2</span> Github</h3>
<p><a href="https://github.com/">Github</a> isn’t specific to R, any code of any type in any state can be uploaded. There is no guarantee a package uploaded to github will even install, nevermind do what it claims to do. R packages can be downloaded and installed directly from github using the “devtools” package installed above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;tallulandrews/M3Drop&quot;</span>)</code></pre></div>
<p>Github is also a version control system which stores multiple versions of any package. By default the most recent “master” version of the package is installed. If you want an older version or the development branch this can be specified using the “ref” parameter:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># different branch</span>
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;tallulandrews/M3D&quot;</span>, <span class="dt">ref=</span><span class="st">&quot;nbumi&quot;</span>)
<span class="co"># previous commit</span>
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;tallulandrews/M3Drop&quot;</span>, <span class="dt">ref=</span><span class="st">&quot;434d2da28254acc8de4940c1dc3907ac72973135&quot;</span>)</code></pre></div>
<p>Note: make sure you re-install the M3Drop master branch for later in the course.</p>
</div>
<div id="bioconductor" class="section level3">
<h3><span class="header-section-number">12.1.3</span> Bioconductor</h3>
<p>Bioconductor is a repository of R-packages specifically for biological analyses. It has the strictest requirements for submission, including installation on every platform and full documentation with a tutorial (called a vignette) explaining how the package should be used. Bioconductor also encourages utilization of standard data structures/classes and coding style/naming conventions, so that, in theory, packages and analyses can be combined into large pipelines or workflows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;https://bioconductor.org/biocLite.R&quot;</span>)
<span class="kw">biocLite</span>(<span class="st">&quot;edgeR&quot;</span>)</code></pre></div>
<p>Note: in some situations it is necessary to substitute “<a href="http://" class="uri">http://</a>” for “<a href="https://" class="uri">https://</a>” in the above depending on the security features of your internet connection/network.</p>
<p>Bioconductor also requires creators to support their packages and has a regular 6-month release schedule. Make sure you are using the most recent release of bioconductor before trying to install packages for the course.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;https://bioconductor.org/biocLite.R&quot;</span>)
<span class="kw">biocLite</span>(<span class="st">&quot;BiocUpgrade&quot;</span>)</code></pre></div>
</div>
<div id="source" class="section level3">
<h3><span class="header-section-number">12.1.4</span> Source</h3>
<p>The final way to install packages is directly from source. In this case you have to download a fully built source code file, usually packagename.tar.gz, or clone the github repository and rebuild the package yourself. Generally this will only be done if you want to edit a package yourself, or if for some reason the former methods have failed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;M3Drop_3.05.00.tar.gz&quot;</span>, <span class="dt">type=</span><span class="st">&quot;source&quot;</span>)</code></pre></div>
</div>
</div>
<div id="installation-instructions" class="section level2">
<h2><span class="header-section-number">12.2</span> Installation instructions:</h2>
<p>All the packages necessary for this course are available <a href="https://github.com/hemberg-lab/scRNA.seq.course/blob/master/Dockerfile">here</a>. Starting from “RUN Rscript -e”install.packages(‘devtools’)&quot; “, run each of the commands (minus”RUN“) on the command line or start an R session and run each of the commands within the quotation marks. Note the ordering of the installation is important in some cases, so make sure you run them in order from top to bottom.</p>
</div>
<div id="data-typesclasses" class="section level2">
<h2><span class="header-section-number">12.3</span> Data-types/classes</h2>
<p>R is a high level language so the underlying data-type is generally not important. The exception if you are accessing R data directly using another language such as C, but that is beyond the scope of this course. Instead we will consider the basic data classes: numeric, integer, logical, and character, and the higher level data class called “factor”. You can check what class your data is using the “class()” function.</p>
<p>Aside: R can also store data as “complex” for complex numbers but generally this isn’t relevant for biological analyses.</p>
<div id="numeric" class="section level3">
<h3><span class="header-section-number">12.3.1</span> Numeric</h3>
<p>The “numeric” class is the default class for storing any numeric data - integers, decimal numbers, numbers in scientific notation, etc…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="fl">1.141</span>
<span class="kw">class</span>(x)</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y =<span class="st"> </span><span class="dv">42</span>
<span class="kw">class</span>(y)</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z =<span class="st"> </span><span class="fl">6.02e23</span>
<span class="kw">class</span>(z)</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>Here we see that even though R has an “integer” class and 42 could be stored more efficiently as an integer the default is to store it as “numeric”. If we want 42 to be stored as an integer we must “coerce” it to that class:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y =<span class="st"> </span><span class="kw">as.integer</span>(<span class="dv">42</span>)
<span class="kw">class</span>(y)</code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<p>Coercion will force R to store data as a particular class, if our data is incompatible with that class it will still do it but the data will be converted to NAs:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.numeric</span>(<span class="st">&quot;H&quot;</span>)</code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<pre><code>## [1] NA</code></pre>
<p>Above we tried to coerce “character” data, identified by the double quotation marks, into numeric data which doesn’t make sense, so we triggered (“threw”) an warning message. Since this is only a warning R would continue with any subsequent commands in a script/function, whereas an “error” would cause R to halt.</p>
</div>
<div id="characterstring" class="section level3">
<h3><span class="header-section-number">12.3.2</span> Character/String</h3>
<p>The “character” class stores all kinds of text data. Programing convention calls data containing multiple letters a “string”, thus most R functions which act on character data will refer to the data as “strings” and will often have “str” or “string” in it’s name. Strings are identified by being flanked by double quotation marks, whereas variable/function names are not:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="dv">5</span>

a =<span class="st"> &quot;x&quot;</span> <span class="co"># character &quot;x&quot;</span>
a</code></pre></div>
<pre><code>## [1] &quot;x&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b =<span class="st"> </span>x <span class="co"># variable x</span>
b</code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>In addition to standard alphanumeric characters, strings can also store various special characters. Special characters are identified using a backlash followed by a single character, the most relevant are the special character for tab : “” and new line : “”. To demonstrate the these special characters lets concatenate (cat) together two strings with these characters separating (sep) them:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;World&quot;</span>, <span class="dt">sep=</span> <span class="st">&quot; &quot;</span>)</code></pre></div>
<pre><code>## Hello World</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;World&quot;</span>, <span class="dt">sep=</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</code></pre></div>
<pre><code>## Hello    World</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;World&quot;</span>, <span class="dt">sep=</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre></div>
<pre><code>## Hello
## World</code></pre>
<p>Note that special characters work differently in different functions. For instance the “paste” function does the same thing as “cat” but does not recognize special characters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;World&quot;</span>, <span class="dt">sep=</span> <span class="st">&quot; &quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;Hello World&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;World&quot;</span>, <span class="dt">sep=</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;Hello\tWorld&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;World&quot;</span>, <span class="dt">sep=</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;Hello\nWorld&quot;</code></pre>
<p>Single or double backslash is also used as an “escape” character to turn off special characters or allow quotation marks to be included in strings:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;This </span><span class="ch">\&quot;</span><span class="st">string</span><span class="ch">\&quot;</span><span class="st"> contains quotation marks.&quot;</span>)</code></pre></div>
<pre><code>## This &quot;string&quot; contains quotation marks.</code></pre>
<p>Special characters are generally only used in pattern matching, and reading/writing data to files. For instance this is how you would read a tab-separated file into R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;file.tsv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</code></pre></div>
<p>Another special type of character data are colours. Colours can be specified in three main ways: by name from those <a href="http://bxhorn.com/r-color-tables/">available</a>, by red, green, blue values using the “rgb” function, and by hue (colour), saturation (colour vs white) and value (colour/white vs black) using the “hsv” function. By default rgb and hsv expect three values in 0-1 with an optional fourth value for transparency. Alternatively, sets of predetermined colours with useful properties can be loaded from many different packages with <a href="http://colorbrewer2.org/">RColorBrewer</a> being one of the most popular.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reds =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="kw">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="kw">hsv</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>))
reds</code></pre></div>
<pre><code>## [1] &quot;red&quot;     &quot;#FF0000&quot; &quot;#FF0000&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">col=</span>reds, <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;by_name&quot;</span>, <span class="st">&quot;by_rgb&quot;</span>, <span class="st">&quot;by_hsv&quot;</span>))</code></pre></div>
<p><img src="09-L3-intro-to-R_files/figure-html/unnamed-chunk-16-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="logical" class="section level3">
<h3><span class="header-section-number">12.3.3</span> Logical</h3>
<p>The “logical” class stores boolean truth values, i.e. TRUE and FALSE. It is used for storing the results of logical operations and conditional statements will be coerced to this class. Most other data-types can be coerced to boolean without triggering (or “throwing”) error messages, which may cause unexpected behaviour.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="ot">TRUE</span>
<span class="kw">class</span>(x)</code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y =<span class="st"> &quot;T&quot;</span>
<span class="kw">as.logical</span>(y)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z =<span class="st"> </span><span class="dv">5</span>
<span class="kw">as.logical</span>(z)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="ot">FALSE</span>
<span class="kw">class</span>(x)</code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y =<span class="st"> &quot;F&quot;</span>
<span class="kw">as.logical</span>(y)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z =<span class="st"> </span><span class="dv">0</span>
<span class="kw">as.logical</span>(z)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p><strong>Exercise 1</strong> Experiment with other character and numeric values, which are coerced to TRUE or FALSE? which are coerced to neither? Do you ever throw a warning/error message?</p>
</div>
<div id="factors" class="section level3">
<h3><span class="header-section-number">12.3.4</span> Factors</h3>
<p>String/Character data is very memory inefficient to store, each letter generally requires the same amount of memory as any integer. Thus when storing a vector of strings with repeated elements it is more efficient assign each element to an integer and store the vector as integers and an additional string-to-integer association table. Thus, by default R will read in text columns of a data table as factors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">str_vector =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Banana&quot;</span>, <span class="st">&quot;Banana&quot;</span>, <span class="st">&quot;Banana&quot;</span>, <span class="st">&quot;Carrot&quot;</span>, <span class="st">&quot;Carrot&quot;</span>, <span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Banana&quot;</span>) 
factored_vector =<span class="st"> </span><span class="kw">factor</span>(str_vector)
factored_vector</code></pre></div>
<pre><code>## [1] Apple  Apple  Banana Banana Banana Carrot Carrot Apple  Banana
## Levels: Apple Banana Carrot</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.numeric</span>(factored_vector)</code></pre></div>
<pre><code>## [1] 1 1 2 2 2 3 3 1 2</code></pre>
<p>The double nature of factors can cause some unintuitive behaviour. E.g. joining two factors together will convert them to the numeric form and the original strings will be lost.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(factored_vector, factored_vector)</code></pre></div>
<pre><code>##  [1] 1 1 2 2 2 3 3 1 2 1 1 2 2 2 3 3 1 2</code></pre>
<p>Likewise if due to formatting issues numeric data is mistakenly interpretted as strings, then you must convert the factor back to strings before coercing to numeric values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;20&quot;</span>, <span class="st">&quot;25&quot;</span>, <span class="st">&quot;23&quot;</span>, <span class="st">&quot;38&quot;</span>, <span class="st">&quot;20&quot;</span>, <span class="st">&quot;40&quot;</span>, <span class="st">&quot;25&quot;</span>, <span class="st">&quot;30&quot;</span>)
x =<span class="st"> </span><span class="kw">factor</span>(x)
<span class="kw">as.numeric</span>(x)</code></pre></div>
<pre><code>## [1] 1 3 2 5 1 6 3 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(x))</code></pre></div>
<pre><code>## [1] 20 25 23 38 20 40 25 30</code></pre>
<p>To make R read text as character data instead of factors set the environment option “stringsAsFactors=FALSE”. This must be done at the start of each R session.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><strong>Exercise</strong> How would you use factors to create a vector of colours for an arbitrarily long vector of fruits like “str_vector” above? <strong>Answer</strong></p>
</div>
<div id="checking-classtype" class="section level3">
<h3><span class="header-section-number">12.3.5</span> Checking class/type</h3>
<p>We recommend checking your data is of the correct class after reading from files:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="fl">1.4</span>
<span class="kw">is.numeric</span>(x)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.character</span>(x)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.logical</span>(x)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.factor</span>(x)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
</div>
<div id="basic-data-structures" class="section level2">
<h2><span class="header-section-number">12.4</span> Basic data structures</h2>
<p>So far we have only looked at single values and vectors. Vectors are the simplest data structure in R. They are a 1-dimensional array of data all of the same type. If the input when creating a vector is of different types it will be coerced to the data-type that is most consistent with the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Hello&quot;</span>, <span class="dv">5</span>, <span class="ot">TRUE</span>)
x</code></pre></div>
<pre><code>## [1] &quot;Hello&quot; &quot;5&quot;     &quot;TRUE&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(x)</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>Here we tried to put character, numeric and logical data into a single vector so all the values were coerced to “character” data.</p>
<p>A “matrix” is the two dimensional version of a vector, it also requires all data to be of the same type. If we combine a character vector and a numeric vector into a matrix, all the data will be coerced to characters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>)
y =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)
<span class="kw">class</span>(x)</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(y)</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m =<span class="st"> </span><span class="kw">cbind</span>(x, y)
m</code></pre></div>
<pre><code>##      x   y  
## [1,] &quot;A&quot; &quot;1&quot;
## [2,] &quot;B&quot; &quot;2&quot;
## [3,] &quot;C&quot; &quot;3&quot;</code></pre>
<p>The quotation marks indicate that the numeric vector has been coerced to characters. Alternatively, to store data with columns of different data-types we can use a dataframe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z =<span class="st"> </span><span class="kw">data.frame</span>(x, y)
z</code></pre></div>
<pre><code>##   x y
## 1 A 1
## 2 B 2
## 3 C 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(z[,<span class="dv">1</span>])</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(z[,<span class="dv">2</span>])</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>If you have set stringsAsFactors=FALSE as above you will find the first column remains characters, otherwise it will be automatically converted to a factor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">stringsAsFactors=</span><span class="ot">TRUE</span>)
z =<span class="st"> </span><span class="kw">data.frame</span>(x, y)
<span class="kw">class</span>(z[,<span class="dv">1</span>])</code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<p>Another difference between matrices and dataframes is the ability to select columns using the “$” operator:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m<span class="op">$</span>x <span class="co"># throws an error</span>
z<span class="op">$</span>x <span class="co"># ok</span></code></pre></div>
<p>The final basic data structure is the “list”. Lists allow data of different types and different lengths to be stored in a single object. Each element of a list can be any other R object : data of any type, any data structure, even other lists or functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l =<span class="st"> </span><span class="kw">list</span>(m, z)
ll =<span class="st"> </span><span class="kw">list</span>(<span class="dt">sublist=</span>l, <span class="dt">a_matrix=</span>m, <span class="dt">numeric_value=</span><span class="dv">42</span>, <span class="dt">this_string=</span><span class="st">&quot;Hello World&quot;</span>, <span class="dt">even_a_function=</span>cbind)
ll</code></pre></div>
<pre><code>## $sublist
## $sublist[[1]]
##      x   y  
## [1,] &quot;A&quot; &quot;1&quot;
## [2,] &quot;B&quot; &quot;2&quot;
## [3,] &quot;C&quot; &quot;3&quot;
## 
## $sublist[[2]]
##   x y
## 1 A 1
## 2 B 2
## 3 C 3
## 
## 
## $a_matrix
##      x   y  
## [1,] &quot;A&quot; &quot;1&quot;
## [2,] &quot;B&quot; &quot;2&quot;
## [3,] &quot;C&quot; &quot;3&quot;
## 
## $numeric_value
## [1] 42
## 
## $this_string
## [1] &quot;Hello World&quot;
## 
## $even_a_function
## function (..., deparse.level = 1) 
## .Internal(cbind(deparse.level, ...))
## &lt;bytecode: 0x7f2172f76da0&gt;
## &lt;environment: namespace:base&gt;</code></pre>
<p>Lists are most commonly used when returning a large number of results from a function that do not fit into any of the previous data structures.</p>
</div>
<div id="more-information" class="section level2">
<h2><span class="header-section-number">12.5</span> More information</h2>
<p>You can get more information about any R commands relevant to these datatypes using by typing “?function” in an interactive session.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="construction-of-expression-matrix.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-types.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["scRNA-seq-course.pdf"],
"toc": {
"collapse": "section"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
